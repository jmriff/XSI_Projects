#include <GL/gl.h>
#include <GL/glut.h>
#include <stdio.h>
#include <math.h>

GLfloat move = 0.0;
GLfloat move_y = 0.0;
GLfloat step = 1.0;

void display( void )
{
   GLubyte fly[] = {
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x03, 0x80, 0x01, 0xc0, 0x06, 0xc0, 0x03, 0x60, 
      0x04, 0x60, 0x06, 0x20, 0x04, 0x30, 0x0c, 0x20,
      0x04, 0x18, 0x18, 0x20, 0x04, 0x0c, 0x30, 0x20,
      0x04, 0x06, 0x60, 0x20, 0x44, 0x03, 0xc0, 0x22,
      0x44, 0x01, 0x80, 0x22, 0x44, 0x01, 0x80, 0x22,
      0x44, 0x01, 0x80, 0x22, 0x44, 0x01, 0x80, 0x22,
      0x44, 0x01, 0x80, 0x22, 0x44, 0x01, 0x80, 0x22,
      0x66, 0x01, 0x80, 0x66, 0x33, 0x01, 0x80, 0xcc,
      0x19, 0x81, 0x81, 0x98, 0x0c, 0xc1, 0x83, 0x30,
      0x07, 0xe1, 0x87, 0xe0, 0x03, 0x3f, 0xfc, 0xc0,
      0x03, 0x31, 0x8c, 0xc0, 0x03, 0x33, 0xcc, 0xc0,
      0x06, 0x64, 0x26, 0x60, 0x0c, 0xcc, 0x33, 0x30,
      0x18, 0xcc, 0x33, 0x18, 0x10, 0xc4, 0x23, 0x08,
      0x10, 0x63, 0xc6, 0x08, 0x10, 0x30, 0x0c, 0x08,
      0x10, 0x18, 0x18, 0x08, 0x10, 0x00, 0x00, 0x08};

   GLubyte halftone[] = {
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55,
      0xaa, 0xaa, 0xaa, 0xaa, 0x55, 0x55, 0x55, 0x55};

   GLubyte arrow[] = {
      0x80, 0x00, 0x00, 0x01,
      0x61, 0x01, 0x80, 0x86,
      0x41, 0x01, 0x80, 0x82,
      0x01, 0x01, 0x80, 0x80,
      0x01, 0x01, 0x80, 0x80,
      0x01, 0x01, 0x80, 0x80,
      0x0d, 0x01, 0x80, 0xb0,
      0x03, 0x01, 0x80, 0xc0,
      0x03, 0x01, 0x80, 0xc0,
      0x01, 0x01, 0x80, 0x80,
      0x01, 0x01, 0x80, 0x80,
      0x01, 0x01, 0x80, 0x80,
      0x00, 0x01, 0x80, 0x00,
      0x00, 0x01, 0x80, 0x00,
      0x00, 0x01, 0x80, 0x00,
      0x00, 0x01, 0x80, 0x00,
      0x00, 0x01, 0x80, 0x00,
      0x00, 0x07, 0xe0, 0x00,
      0x03, 0xfd, 0xbf, 0xc0,
      0x0c, 0x01, 0x80, 0x30,
      0x0c, 0x00, 0x00, 0x30,
      0x03, 0xfc, 0x3f, 0xc0,
      0x00, 0x83, 0xc1, 0x00,
      0x00, 0x70, 0x0e, 0x00,
      0x00, 0x18, 0x18, 0x00,
      0x00, 0x0c, 0x30, 0x00,
      0x00, 0x06, 0x60, 0x00,
      0x00, 0x02, 0x40, 0x00,
      0x00, 0x02, 0x40, 0x00,
      0x40, 0x01, 0x80, 0x02,
      0x60, 0x01, 0x80, 0x06,
      0x80, 0x00, 0x00, 0x01};






   glClear( GL_COLOR_BUFFER_BIT );
   glColor3f( 1.0, 1.0, 1.0 );

   /* draw one solid, ontrippled rectangle,
    * then two stippled rectangles
    */
   glEnable( GL_POLYGON_STIPPLE );
   glPolygonStipple( arrow );
   glRectf( move, move, move+100.0, move+100.0 );
   
   glColor3f( 1.0, 0.0, 0.0 );
   glPolygonStipple( fly );
   glRectf( 125.0, move, 225.0, move+100 );

   glColor3f( 0.0, 1.0, 0.0 );
   glPolygonStipple( halftone );
   glRectf( move+100, move+100,  move-1000, move-1000 );
   
   glColor3f( 0.0, 0.0, 1.0 );
   glPolygonStipple( arrow );
   move_y = (15 * sin(.2 * move )) + (400-move);
   glRectf( move , move_y, move+100, move_y+100 );
   glDisable( GL_POLYGON_STIPPLE );

   glutSwapBuffers();

}

void init( void )
{
   glClearColor( 0.0, 0.0, 0.0, 0.0 );
   glShadeModel( GL_FLAT );
}

void reshape( int w, int h )
{
   glViewport( 0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode( GL_PROJECTION );
   glLoadIdentity();
   gluOrtho2D( 0.0, (GLdouble) w, 0.0, (GLdouble) h );
}

void keyboard (unsigned char key, int x, int y )
{
   if (key == 27) exit( 0 );
}

void travel( void )
{
   move = move + step;
   if (move > 400.0 ) step = -1.0f;
   if (move < 5.0 ) step = 1.0f;

   glutPostRedisplay();
}

int main( int argc, char** argv )
{
   glutInit( &argc, argv );
   glutInitDisplayMode( GLUT_DOUBLE | GLUT_RGB );
   glutInitWindowSize( 350, 150 );
   glutCreateWindow( argv[0] );
   init();
   glutDisplayFunc( display );
   glutReshapeFunc( reshape );
   glutKeyboardFunc( keyboard );
   glutIdleFunc( travel );
   glutMainLoop();
   return 0;
}

